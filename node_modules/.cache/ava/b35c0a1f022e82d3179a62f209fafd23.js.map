{"version":3,"sources":["test/data.js"],"names":["test","before","t","context","api","feedObject","name","description","feed","beforeEach","data","value","respData","post","key","is","status","toString","feed_key","serial"],"mappings":";;AAAA;;AACA;;;;AAQAA,aAAKC,MAAL,CAAY,aAAZ,EAA2B,MAAMC,CAAN,IAAW;AAClC;AACAA,EAAAA,CAAC,CAACC,OAAF,CAAUC,GAAV,GAAgB,MAAM,wBAAtB;AACA,uBAAKF,CAAC,CAACC,OAAF,CAAUC,GAAf,EAHkC,CAKlC;;AACA,QAAMC,UAAU,GAAG;AAAEC,IAAAA,IAAI,EAAE,yBAAR;AAAmCC,IAAAA,WAAW,EAAE;AAAhD,GAAnB;AACAL,EAAAA,CAAC,CAACC,OAAF,CAAUK,IAAV,GAAiB,MAAM,2BAAWN,CAAX,EAAcA,CAAC,CAACC,OAAF,CAAUC,GAAxB,EAA6BC,UAA7B,CAAvB;AACH,CARD;;AAUAL,aAAKS,UAAL,CAAgB,WAAhB,EAA6B,MAAMP,CAAN,IAAW;AACpCA,EAAAA,CAAC,CAACC,OAAF,CAAUC,GAAV,GAAgB,MAAM,wBAAtB;AACA,uBAAKF,CAAC,CAACC,OAAF,CAAUC,GAAf;AACH,CAHD;;AAKA,kBAAK,wBAAL,EAA+B,MAAMF,CAAN,IAAW;AACtC,QAAMQ,IAAI,GAAG;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAAb;AACA,QAAMC,QAAQ,GAAG,MAAMV,CAAC,CAACC,OAAF,CAAUC,GAAV,CAAcS,IAAd,CAAoB,UAASX,CAAC,CAACC,OAAF,CAAUK,IAAV,CAAeM,GAAI,OAAhD,EAAwDJ,IAAxD,CAAvB;AACAR,EAAAA,CAAC,CAACa,EAAF,CAAKH,QAAQ,CAACI,MAAd,EAAsB,GAAtB,EAA2B,mCAAIJ,QAAJ,CAA3B;AACAV,EAAAA,CAAC,CAACa,EAAF,CAAKH,QAAQ,CAACF,IAAT,CAAcC,KAAnB,EAA0BD,IAAI,CAACC,KAAL,CAAWM,QAAX,EAA1B;AACAf,EAAAA,CAAC,CAACa,EAAF,CAAKH,QAAQ,CAACF,IAAT,CAAcQ,QAAnB,EAA6BhB,CAAC,CAACC,OAAF,CAAUK,IAAV,CAAeM,GAA5C;AACH,CAND,E,CAQA;;AACAd,aAAKmB,MAAL,CAAY,2CAAZ,EAAyD,MAAMjB,CAAN,IAAW;AAChE,yBAAOA,CAAC,CAACC,OAAF,CAAUC,GAAjB;AAEA,QAAMM,IAAI,GAAG;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAAb;AACA,QAAMC,QAAQ,GAAG,MAAMV,CAAC,CAACC,OAAF,CAAUC,GAAV,CAAcS,IAAd,CAAoB,UAASX,CAAC,CAACC,OAAF,CAAUK,IAAV,CAAeM,GAAI,OAAhD,EAAwDJ,IAAxD,CAAvB;AACAR,EAAAA,CAAC,CAACa,EAAF,CAAKH,QAAQ,CAACI,MAAd,EAAsB,GAAtB,EAA2B,mCAAIJ,QAAJ,CAA3B;AACH,CAND","sourceRoot":"/home/kate/moeco/adafruit","sourcesContent":["import test from 'ava';\nimport {\n    getApi,\n    auth,\n    logout,\n    createFeed,\n    responseErrMessage as err\n} from './helpers/shortcuts';\n\ntest.before('Create feed', async t => {\n    // Authorise\n    t.context.api = await getApi();\n    auth(t.context.api);\n\n    // Create feed\n    const feedObject = { name: 'autotest-feed-with-data', description: 'feed generated by api autotest with data'};\n    t.context.feed = await createFeed(t, t.context.api, feedObject);\n});\n\ntest.beforeEach('Authorise', async t => {\n    t.context.api = await getApi();\n    auth(t.context.api);\n});\n\ntest('Add data to feed works', async t => {\n    const data = { value: 42 };\n    const respData = await t.context.api.post(`/feeds/${t.context.feed.key}/data`, data);\n    t.is(respData.status, 200, err(respData));\n    t.is(respData.data.value, data.value.toString());\n    t.is(respData.data.feed_key, t.context.feed.key);\n});\n\n// Serial because logout influences parallel tests otherwise\ntest.serial('Add data to feed fails without auth token', async t => {\n    logout(t.context.api);\n\n    const data = { value: 42 };\n    const respData = await t.context.api.post(`/feeds/${t.context.feed.key}/data`, data);\n    t.is(respData.status, 404, err(respData));\n});"]}