"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.deleteFeed = exports.createFeed = exports.responseErrMessage = exports.logout = exports.auth = exports.getApi = void 0;

var _axios = _interopRequireDefault(require("axios"));

var _fixtures = require("./fixtures");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// curl -H "X-AIO-Key: b780002b85d6411ca0ad9f9c60195f72" \
// https://io.adafruit.com/api/v2/test_username/feeds
const getApi = async () => {
  const client = _axios.default.create({
    baseURL: _fixtures.BASE_URL + _fixtures.ADAFRUIT_IO_USERNAME,

    validateStatus() {
      return true;
    }

  });

  return client;
};

exports.getApi = getApi;

const auth = api => {
  api.defaults.headers['X-AIO-Key'] = _fixtures.ADAFRUIT_IO_KEY;
};

exports.auth = auth;

const logout = api => {
  delete api.defaults.headers['X-AIO-Key'];
};

exports.logout = logout;

const responseErrMessage = response => {
  return JSON.stringify(response.data, null, 2);
};

exports.responseErrMessage = responseErrMessage;

const createFeed = async (t, api, feedObject = _fixtures.feed.defaultObj) => {
  const resp = await api.post('/feeds', feedObject);
  t.is(resp.status, 201, responseErrMessage(resp));
  return resp.data;
};

exports.createFeed = createFeed;

const deleteFeed = async (t, api, feedKey) => {
  const resp = await api.delete(`/feeds/${feedKey}`);
  t.is(resp.status, 200, responseErrMessage(resp));
  return resp.data;
}; // TODO: Also add tv4 validation
// TODO: Matrix testing demo


exports.deleteFeed = deleteFeed;
//# sourceMappingURL=/home/kate/moeco/adafruit/node_modules/.cache/ava/ec91e7357bb3c3f301649076ce79accb.js.map